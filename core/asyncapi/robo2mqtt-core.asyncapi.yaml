asyncapi: '2.6.0'
info:
  title: Robo2MQTT Core API
  version: '1.0.0'
  description: |
    Core MQTT API for all Robo2MQTT-compatible robots.
    Robot-specific specs extend this core.

defaultContentType: application/json

components:
  parameters:
    robotId:
      description: Unique robot identifier
      schema:
        type: string

channels:

  # Robot lifecycle
  robo2mqtt/{robotId}/status:
    parameters:
      robotId:
        $ref: '#/components/parameters/robotId'
    description: Robot online/offline/ready
    publish:
      message:
        $ref: '../schema/common.yaml#/components/messages/Status'

  # Speech
  robo2mqtt/{robotId}/cmd/speech/say:
    parameters:
      robotId:
        $ref: '#/components/parameters/robotId'
    subscribe:
      message:
        $ref: '../schema/speech.yaml#/components/messages/SayCommand'

  # Movement
  robo2mqtt/{robotId}/cmd/movement/goto:
    parameters:
      robotId:
        $ref: '#/components/parameters/robotId'
    subscribe:
      message:
        $ref: '../schema/movement.yaml#/components/messages/GoToCommand'

  robo2mqtt/{robotId}/event/movement/status:
    parameters:
      robotId:
        $ref: '#/components/parameters/robotId'
    publish:
      message:
        $ref: '../schema/movement.yaml#/components/messages/MovementStatus'

  # UI
  robo2mqtt/{robotId}/cmd/ui/askYesNo:
    parameters:
      robotId:
        $ref: '#/components/parameters/robotId'
    subscribe:
      message:
        $ref: '../schema/ui.yaml#/components/messages/AskYesNo'

  robo2mqtt/{robotId}/event/ui/answer:
    parameters:
      robotId:
        $ref: '#/components/parameters/robotId'
    publish:
      message:
        $ref: '../schema/ui.yaml#/components/messages/UIAnswer'

  # Apps
  robo2mqtt/{robotId}/cmd/apps/start:
    parameters:
      robotId:
        $ref: '#/components/parameters/robotId'
    subscribe:
      message:
        $ref: '../schema/apps.yaml#/components/messages/StartApp'

  robo2mqtt/{robotId}/event/apps/list:
    parameters:
      robotId:
        $ref: '#/components/parameters/robotId'
    publish:
      message:
        $ref: '../schema/apps.yaml#/components/messages/AppList'

  # Media (WebRTC)
  robo2mqtt/{robotId}/event/media/offer:
    parameters:
      robotId:
        $ref: '#/components/parameters/robotId'
    publish:
      message:
        $ref: '../schema/media.yaml#/components/messages/MediaOffer'

  robo2mqtt/{robotId}/event/media/ice:
    parameters:
      robotId:
        $ref: '#/components/parameters/robotId'
    publish:
      message:
        $ref: '../schema/media.yaml#/components/messages/MediaIce'
